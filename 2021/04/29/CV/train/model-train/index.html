<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="模型训练训练流程概述参数初始化 InitializerConstantRandomXavierKaimingPre-trained Weight完全预训练部分与训练优化器 OptimizerSGDSGDMStochastic Gradient Descent with Momentum NAGNesterov Accelerated Gradient 平均梯度 AdaGradAdaptive Gr">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2021/04/29/CV/train/model-train/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="模型训练训练流程概述参数初始化 InitializerConstantRandomXavierKaimingPre-trained Weight完全预训练部分与训练优化器 OptimizerSGDSGDMStochastic Gradient Descent with Momentum NAGNesterov Accelerated Gradient 平均梯度 AdaGradAdaptive Gr">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="f:/blog/CV/train/imgs/crossentropy.png">
<meta property="og:image" content="f:/blog/CV/train/imgs/BCE.png">
<meta property="og:image" content="f:/blog/CV/train/imgs/BBCE.png">
<meta property="og:image" content="f:/blog/CV/train/imgs/focalloss.png">
<meta property="og:image" content="f:/blog/CV/train/imgs/diceloss.png">
<meta property="og:image" content="f:/blog/CV/train/imgs/softmax.png">
<meta property="og:image" content="f:/blog/CV/train/imgs/softmax2.png">
<meta property="og:image" content="f:/blog/CV/train/imgs/sigmoid.png">
<meta property="og:image" content="f:/blog/CV/train/imgs/sigmoid2.png">
<meta property="og:image" content="f:/blog/CV/train/imgs/ce+softmax.png">
<meta property="og:image" content="f:/blog/CV/train/imgs/mse.png">
<meta property="article:published_time" content="2021-04-29T03:06:25.151Z">
<meta property="article:modified_time" content="2021-04-22T08:10:25.770Z">
<meta property="article:author" content="Cheng Zixu">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="f:/blog/CV/train/imgs/crossentropy.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-CV/train/model-train" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/29/CV/train/model-train/" class="article-date">
  <time class="dt-published" datetime="2021-04-29T03:06:25.151Z" itemprop="datePublished">2021-04-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="模型训练"><a href="#模型训练" class="headerlink" title="模型训练"></a>模型训练</h1><h2 id="训练流程概述"><a href="#训练流程概述" class="headerlink" title="训练流程概述"></a>训练流程概述</h2><h2 id="参数初始化-Initializer"><a href="#参数初始化-Initializer" class="headerlink" title="参数初始化 Initializer"></a>参数初始化 Initializer</h2><h3 id="Constant"><a href="#Constant" class="headerlink" title="Constant"></a>Constant</h3><h3 id="Random"><a href="#Random" class="headerlink" title="Random"></a>Random</h3><h3 id="Xavier"><a href="#Xavier" class="headerlink" title="Xavier"></a>Xavier</h3><h3 id="Kaiming"><a href="#Kaiming" class="headerlink" title="Kaiming"></a>Kaiming</h3><h3 id="Pre-trained-Weight"><a href="#Pre-trained-Weight" class="headerlink" title="Pre-trained Weight"></a>Pre-trained Weight</h3><h4 id="完全预训练"><a href="#完全预训练" class="headerlink" title="完全预训练"></a>完全预训练</h4><h4 id="部分与训练"><a href="#部分与训练" class="headerlink" title="部分与训练"></a>部分与训练</h4><h2 id="优化器-Optimizer"><a href="#优化器-Optimizer" class="headerlink" title="优化器 Optimizer"></a>优化器 Optimizer</h2><h4 id="SGD"><a href="#SGD" class="headerlink" title="SGD"></a>SGD</h4><h4 id="SGDM"><a href="#SGDM" class="headerlink" title="SGDM"></a>SGDM</h4><p>Stochastic Gradient Descent with Momentum</p>
<h4 id="NAG"><a href="#NAG" class="headerlink" title="NAG"></a>NAG</h4><p>Nesterov Accelerated Gradient 平均梯度</p>
<h4 id="AdaGrad"><a href="#AdaGrad" class="headerlink" title="AdaGrad"></a>AdaGrad</h4><p>Adaptive Gradient</p>
<p>缺点：随着t推移，a趋向于0，梯度消失，难以训练</p>
<h4 id="RMSProp"><a href="#RMSProp" class="headerlink" title="RMSProp"></a>RMSProp</h4><p>RootMeanSquare Propogation</p>
<h4 id="AdaDelta"><a href="#AdaDelta" class="headerlink" title="AdaDelta"></a>AdaDelta</h4><p>Adaptive Delta</p>
<h4 id="Adam"><a href="#Adam" class="headerlink" title="Adam"></a>Adam</h4><p>Adaptive Moments Estimation</p>
<p>比SGD快很多但收敛性没那么好</p>
<h4 id="L2正则化-Weight-Decay-AdamW"><a href="#L2正则化-Weight-Decay-AdamW" class="headerlink" title="L2正则化/ Weight Decay/AdamW"></a>L2正则化/ Weight Decay/AdamW</h4><p>L2正则化与Weight Decay是等价的</p>
<p>AdamW Adam with decoupled weight decay</p>
<h2 id="学习率调整-LR-Scheduler"><a href="#学习率调整-LR-Scheduler" class="headerlink" title="学习率调整 LR Scheduler"></a>学习率调整 LR Scheduler</h2><h3 id="衰减式"><a href="#衰减式" class="headerlink" title="衰减式"></a>衰减式</h3><h4 id="StepLR"><a href="#StepLR" class="headerlink" title="StepLR"></a>StepLR</h4><h4 id="MultiStepLR"><a href="#MultiStepLR" class="headerlink" title="MultiStepLR"></a>MultiStepLR</h4><h4 id="ExponentialLR"><a href="#ExponentialLR" class="headerlink" title="ExponentialLR"></a>ExponentialLR</h4><h3 id="循环式"><a href="#循环式" class="headerlink" title="循环式"></a>循环式</h3><h4 id="CosineAnnealingLR"><a href="#CosineAnnealingLR" class="headerlink" title="CosineAnnealingLR"></a>CosineAnnealingLR</h4><h4 id="CyclicLR"><a href="#CyclicLR" class="headerlink" title="CyclicLR"></a>CyclicLR</h4><h3 id="自适应"><a href="#自适应" class="headerlink" title="自适应"></a>自适应</h3><h4 id="ReduceLROnPlateau"><a href="#ReduceLROnPlateau" class="headerlink" title="ReduceLROnPlateau"></a>ReduceLROnPlateau</h4><p>•torch.optim.lr_scheduler.ReduceLROnPlateau(optimizer, mode=’min’, factor=0.1, patience=10, threshold=0.0001, threshold_mode=’rel’, cooldown=0, min_lr=0, eps=1e-08, verbose=False)</p>
<p>•Example: scheduler.step(val_loss)</p>
<h3 id="手动调整"><a href="#手动调整" class="headerlink" title="手动调整"></a>手动调整</h3><h2 id="损失函数"><a href="#损失函数" class="headerlink" title="损失函数"></a>损失函数</h2><h3 id="Cross-Entropy-Loss"><a href="#Cross-Entropy-Loss" class="headerlink" title="Cross Entropy Loss"></a>Cross Entropy Loss</h3><img src="F:\blog\CV\train\imgs\crossentropy.png" style="zoom:48%;" />

<p>Cross Entropy + Softmax =&gt; 得到一组和为1的概率数组。</p>
<h3 id="Binary-Cross-Entropy-Loss"><a href="#Binary-Cross-Entropy-Loss" class="headerlink" title="Binary Cross Entropy Loss"></a>Binary Cross Entropy Loss</h3><img src="F:\blog\CV\train\imgs\BCE.png" style="zoom:48%;" />

<p>BCE + Sigmoid =&gt; 得到一个(0, 1)之间的概率。</p>
<h3 id="Balance-Binary-Cross-Entropy-Loss"><a href="#Balance-Binary-Cross-Entropy-Loss" class="headerlink" title="Balance Binary Cross Entropy Loss"></a>Balance Binary Cross Entropy Loss</h3><img src="F:\blog\CV\train\imgs\BBCE.png" style="zoom:48%;" />

<p>一定程度上解决正负样本不平衡问题</p>
<h3 id="Focal-Loss"><a href="#Focal-Loss" class="headerlink" title="Focal Loss"></a>Focal Loss</h3><p><img src="F:\blog\CV\train\imgs\focalloss.png" alt="L=-α〖(1-p)〗^γ ylogp-(1-α) p^γ (1-y)log⁡(1-p)"></p>
<p>给难易样本加上权重γ，更关注难样本的学习。</p>
<p>同时考虑样本平衡与样本难易；样本平衡与样本难易有一定的关联。</p>
<h3 id="Dice-Loss"><a href="#Dice-Loss" class="headerlink" title="Dice Loss"></a>Dice Loss</h3><p>语义分割常用Loss</p>
<p><img src="F:\blog\CV\train\imgs\diceloss.png"></p>
<p>Dice Coefficient是IoU的分子分母都加上|X|∩|Y|，与IoU是正相关，Dice Loss是1 - Dice Coefficient，这么做是为了方便求导。</p>
<p>Dice Loss为了防止分母为0，通常在分母加上eps，或者加上拉普拉斯平滑即分子分母同时加上1。</p>
<p>在语义分割中，计算IoU的方法是|X|∩|Y| = ∑ gt * pred ，gt * pred得到某个像素的概率交集，每个像素求和得到整体的概率交集 ；|X|+|Y| = ∑ gt + pred。</p>
<h2 id="激活函数"><a href="#激活函数" class="headerlink" title="激活函数"></a>激活函数</h2><h3 id="Softmax"><a href="#Softmax" class="headerlink" title="Softmax"></a>Softmax</h3><img src="F:\blog\CV\train\imgs\softmax.png" style="zoom:48%;" />

<p>对其求导得：</p>
<img src="F:\blog\CV\train\imgs\softmax2.png" style="zoom:48%;" />

<h3 id="Sigmoid"><a href="#Sigmoid" class="headerlink" title="Sigmoid"></a>Sigmoid</h3><img src="F:\blog\CV\train\imgs\sigmoid.png" style="zoom:48%;" />

<img src="F:\blog\CV\train\imgs\sigmoid2.png" style="zoom:48%;" />



<h3 id="CrossEntropy-Softmax"><a href="#CrossEntropy-Softmax" class="headerlink" title="CrossEntropy + Softmax"></a>CrossEntropy + Softmax</h3><p>求导后化简的形式很漂亮。</p>
<img src="F:\blog\CV\train\imgs\ce+softmax.png" style="zoom:48%;" />

<h3 id="MSE-Softmax"><a href="#MSE-Softmax" class="headerlink" title="MSE + Softmax"></a>MSE + Softmax</h3><p>若使用MSE损失函数做分类，则求导有：</p>
<img src="F:\blog\CV\train\imgs\mse.png" style="zoom:20%;" />

<p>导数是3个(0, 1)之间的数相乘，容易造成梯度消失，因此分类不用MSE。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/04/29/CV/train/model-train/" data-id="cko2b5emg000h2wvc2cgm7bex" data-title="" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/04/29/CV/YOLO/Yolo%E7%B3%BB%E5%88%97%E6%A3%80%E6%B5%8B%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Neuer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2021/04/29/CV/train/data-preprocessing/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Älter</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/04/29/CV/YOLO/Yolo%E7%B3%BB%E5%88%97%E6%A3%80%E6%B5%8B%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/04/29/CV/train/model-train/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/04/29/CV/train/data-preprocessing/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/04/29/CV/RCNN-family/RCNN%EF%BC%8CFast%20RCNN%EF%BC%8CFaster%20RCNN%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/04/29/CV/facebagnet&attention/SENet/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Cheng Zixu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>